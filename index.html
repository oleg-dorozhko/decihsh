<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <title>PUHLYA Verify üç©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family: system-ui, sans-serif; text-align:center; background:#1a001a; color:#fff; padding:40px}
    h1{color:#ff69b4}
    .drop{border:4px dashed #ff69b4; padding:60px; border-radius:20px; margin:40px auto; max-width:500px; cursor:pointer}
    .drop.dragover{background:#ff69b430}
    #result{margin:30px; padding:20px; background:#00000080; border-radius:15px; font-size:18px}
    a{color:#ffb6c1; text-decoration:underline}
  </style>
</head>
<body>
  <h1>üç© PUHLYA Verify</h1>
  <p>–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –∞–≤–∞—Ç–∞—Ä–∫—É –∞–±–æ –æ—Ñ—ñ—Ü—ñ–π–Ω—É –∫–∞—Ä—Ç–∏–Ω–∫—É PUHLYA —Å—é–¥–∏</p>
  <div class="drop" id="drop">–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ —Ñ–∞–π–ª –∞–±–æ –∫–ª—ñ–∫–Ω–∏</div>
  <div id="result"></div>

  <input type="file" id="file" accept="image/*" style="display:none">

  <script>
  const drop = document.getElementById('drop');
  const fileInput = document.getElementById('file');
  const result = document.getElementById('result');

  ['dragover','dragenter'].forEach(e=>drop.addEventListener(e, ev=>ev.preventDefault()));
  drop.addEventListener('dragover', ()=>drop.classList.add('dragover'));
  drop.addEventListener('dragleave', ()=>drop.classList.remove('dragover'));
  drop.addEventListener('drop', e=>{
    e.preventDefault();
    drop.classList.remove('dragover');
    if(e.dataTransfer.files[0]) handle(e.dataTransfer.files[0]);
  });
  drop.addEventListener('click', ()=>fileInput.click());
  fileInput.addEventListener('change', e=>e.target.files[0]&&handle(e.target.files[0]));

  function handle(file){
    const reader = new FileReader();
    reader.onload = e=>{
      const img = new Image();
      img.onload = ()=>extractAndShow(img);
      img.src = e.target.result;
    }
    reader.readAsDataURL(file);
  }

  function extractAndShow(img){
    const canvas = document.createElement('canvas');
    canvas.width = img.width; canvas.height = img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img,0,0);
    const data = ctx.getImageData(0,0,img.width,img.height).data;

    let bytes = [];
    for(let i=0; i<256; i+=4){               // —á–∏—Ç–∞—î–º–æ –ø–µ—Ä—à—ñ 32 –ø—ñ–∫—Å–µ–ª—ñ ‚Üí 32 –±–∞–π—Ç–∏
      let r = data[i], g = data[i+1], b = data[i+2], a = data[i+3]||255;
      bytes.push((r&3)<<6 | (g&3)<<4 | (b&3)<<2 | (a&3));
    }
    const hex = Array.from(bytes, b=>b.toString(16).padStart(2,'0')).join('');
    const expected = "bafkreifpxmsccr4by7nhwnubwtjur4ofajchqouj6xhmw5oq7v6zlggoby";

    if(hex.includes(expected)){
      result.innerHTML = `
        <b>–ó–Ω–∞–π–¥–µ–Ω–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π IPFS-—Ö–µ—à!</b><br><br>
        <code style="font-size:120%; background:#000; padding:10px; border-radius:8px">
          ${expected}
        </code><br><br>
        <a href="https://ipfs.io/ipfs/${expected}" target="_blank">
          –í—ñ–¥–∫—Ä–∏—Ç–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç PUHLYA –Ω–∞ IPFS ‚Üí
        </a>
      `;
    } else {
      result.innerHTML = "–•–µ—à –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –¶–µ –Ω–µ –æ—Ñ—ñ—Ü—ñ–π–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ PUHLYA.";
    }
  }
  </script>
</body>
</html>
